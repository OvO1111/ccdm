2024-05-11 16:36:27,323 INFO    MainThread:42255 [wandb_setup.py:_flush():76] Current SDK version is 0.17.0
2024-05-11 16:36:27,324 INFO    MainThread:42255 [wandb_setup.py:_flush():76] Configure stats pid to 42255
2024-05-11 16:36:27,325 INFO    MainThread:42255 [wandb_setup.py:_flush():76] Loading settings from /ailab/user/dailinrui/.config/wandb/settings
2024-05-11 16:36:27,325 INFO    MainThread:42255 [wandb_setup.py:_flush():76] Loading settings from /ailab/user/dailinrui/code/ccdm/wandb/settings
2024-05-11 16:36:27,325 INFO    MainThread:42255 [wandb_setup.py:_flush():76] Loading settings from environment variables: {}
2024-05-11 16:36:27,325 INFO    MainThread:42255 [wandb_setup.py:_flush():76] Applying setup settings: {'_disable_service': False}
2024-05-11 16:36:27,325 INFO    MainThread:42255 [wandb_setup.py:_flush():76] Inferring run settings from compute environment: {'program_relpath': 'run_trainer.py', 'program_abspath': '/ailab/user/dailinrui/code/ccdm/run_trainer.py', 'program': 'run_trainer.py'}
2024-05-11 16:36:27,325 INFO    MainThread:42255 [wandb_setup.py:_flush():76] Applying login settings: {}
2024-05-11 16:36:27,325 INFO    MainThread:42255 [wandb_init.py:_log_setup():520] Logging user logs to /ailab/user/dailinrui/code/ccdm/test/wandb/run-20240511_163627-oco4oefh/logs/debug.log
2024-05-11 16:36:27,326 INFO    MainThread:42255 [wandb_init.py:_log_setup():521] Logging internal logs to /ailab/user/dailinrui/code/ccdm/test/wandb/run-20240511_163627-oco4oefh/logs/debug-internal.log
2024-05-11 16:36:27,326 INFO    MainThread:42255 [wandb_init.py:init():560] calling init triggers
2024-05-11 16:36:27,326 INFO    MainThread:42255 [wandb_init.py:init():567] wandb.init called with sweep_config: {}
config: {'dataset': {'train': {'target': 'datasets.ruijin.Ruijin_3D_Mask', 'params': {'split': 'train', 'max_size': 5}}, 'validation': {'target': 'datasets.ruijin.Ruijin_3D_Mask', 'params': {'split': 'val', 'max_size': 1}}, 'test': {'target': 'datasets.ruijin.Ruijin_3D_Mask', 'params': {'split': 'test', 'max_size': 8}}}, 'model': {'target': 'train.ccdm.CategoricalDiffusionModel', 'params': {'train_ddim_sigmas': False, 'diffusion_model_spec': {'schedule': 'cosine'}, 'denoising_model_spec': {'unet': {'target': 'ddpm.models.unet_openai.unet.UNetModel', 'params': {'model_channels': 64, 'num_res_blocks': 2, 'cond_encoded_shape': None, 'num_heads': 1, 'num_head_channels': 32, 'channel_mult': [1, 2, 2, 4, 8], 'attention_resolutions': [32, 16, 8], 'use_checkpoint': True, 'dims': 3, 'use_spatial_transformer': True, 'transformer_depth': 1, 'context_dim': 5120, 'ce_head': False}}, 'params': {'step_T_sample': 'majority'}}}}, 'encoder': {'data_encoder': None, 'condition_encoder': None, 'context_encoder': {'target': 'ddpm.models.encoder.AbstractEncoder', 'params': None}}, 'trainer': {'target': 'train.trainer.Trainer', 'params': {'batch_size': 1, 'max_epochs': 50, 'timesteps': 1000, 'lr': 0.0001, 'snapshot_path': '/ailab/user/dailinrui/code/ccdm/test'}}}
2024-05-11 16:36:27,326 INFO    MainThread:42255 [wandb_init.py:init():610] starting backend
2024-05-11 16:36:27,326 INFO    MainThread:42255 [wandb_init.py:init():614] setting up manager
2024-05-11 16:36:27,331 INFO    MainThread:42255 [backend.py:_multiprocessing_setup():105] multiprocessing start_methods=fork,spawn,forkserver, using: spawn
2024-05-11 16:36:27,362 INFO    MainThread:42255 [wandb_init.py:init():622] backend started and connected
2024-05-11 16:36:27,374 INFO    MainThread:42255 [wandb_init.py:init():711] updated telemetry
2024-05-11 16:36:27,397 INFO    MainThread:42255 [wandb_init.py:init():744] communicating run to backend with 90.0 second timeout
2024-05-11 16:36:55,598 INFO    Thread-6 (wrapped_target):42255 [retry.py:__call__():172] Retry attempt failed:
Traceback (most recent call last):
  File "/ailab/user/dailinrui/.conda/envs/ccdm/lib/python3.11/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ailab/user/dailinrui/.conda/envs/ccdm/lib/python3.11/site-packages/urllib3/util/connection.py", line 72, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ailab/user/dailinrui/.conda/envs/ccdm/lib/python3.11/socket.py", line 962, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno -2] Name or service not known

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ailab/user/dailinrui/.conda/envs/ccdm/lib/python3.11/site-packages/urllib3/connectionpool.py", line 703, in urlopen
    httplib_response = self._make_request(
                       ^^^^^^^^^^^^^^^^^^^
  File "/ailab/user/dailinrui/.conda/envs/ccdm/lib/python3.11/site-packages/urllib3/connectionpool.py", line 386, in _make_request
    self._validate_conn(conn)
  File "/ailab/user/dailinrui/.conda/envs/ccdm/lib/python3.11/site-packages/urllib3/connectionpool.py", line 1042, in _validate_conn
    conn.connect()
  File "/ailab/user/dailinrui/.conda/envs/ccdm/lib/python3.11/site-packages/urllib3/connection.py", line 358, in connect
    self.sock = conn = self._new_conn()
                       ^^^^^^^^^^^^^^^^
  File "/ailab/user/dailinrui/.conda/envs/ccdm/lib/python3.11/site-packages/urllib3/connection.py", line 186, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPSConnection object at 0x2b604b847190>: Failed to establish a new connection: [Errno -2] Name or service not known

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ailab/user/dailinrui/.conda/envs/ccdm/lib/python3.11/site-packages/requests/adapters.py", line 489, in send
    resp = conn.urlopen(
           ^^^^^^^^^^^^^
  File "/ailab/user/dailinrui/.conda/envs/ccdm/lib/python3.11/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    retries = retries.increment(
              ^^^^^^^^^^^^^^^^^^
  File "/ailab/user/dailinrui/.conda/envs/ccdm/lib/python3.11/site-packages/urllib3/util/retry.py", line 592, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='api.wandb.ai', port=443): Max retries exceeded with url: /graphql (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x2b604b847190>: Failed to establish a new connection: [Errno -2] Name or service not known'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ailab/user/dailinrui/.conda/envs/ccdm/lib/python3.11/site-packages/wandb/sdk/lib/retry.py", line 131, in __call__
    result = self._call_fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ailab/user/dailinrui/.conda/envs/ccdm/lib/python3.11/site-packages/wandb/sdk/internal/internal_api.py", line 340, in execute
    return self.client.execute(*args, **kwargs)  # type: ignore
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ailab/user/dailinrui/.conda/envs/ccdm/lib/python3.11/site-packages/wandb/vendor/gql-0.2.0/wandb_gql/client.py", line 52, in execute
    result = self._get_result(document, *args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ailab/user/dailinrui/.conda/envs/ccdm/lib/python3.11/site-packages/wandb/vendor/gql-0.2.0/wandb_gql/client.py", line 60, in _get_result
    return self.transport.execute(document, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ailab/user/dailinrui/.conda/envs/ccdm/lib/python3.11/site-packages/wandb/sdk/lib/gql_request.py", line 58, in execute
    request = self.session.post(self.url, **post_args)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ailab/user/dailinrui/.conda/envs/ccdm/lib/python3.11/site-packages/requests/sessions.py", line 635, in post
    return self.request("POST", url, data=data, json=json, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ailab/user/dailinrui/.conda/envs/ccdm/lib/python3.11/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ailab/user/dailinrui/.conda/envs/ccdm/lib/python3.11/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ailab/user/dailinrui/.conda/envs/ccdm/lib/python3.11/site-packages/requests/adapters.py", line 565, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPSConnectionPool(host='api.wandb.ai', port=443): Max retries exceeded with url: /graphql (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x2b604b847190>: Failed to establish a new connection: [Errno -2] Name or service not known'))
2024-05-11 16:37:27,553 WARNING MainThread:42255 [wandb_init.py:init():1168] interrupted
Traceback (most recent call last):
  File "/ailab/user/dailinrui/.conda/envs/ccdm/lib/python3.11/site-packages/wandb/sdk/wandb_init.py", line 1164, in init
    return wi.init()
           ^^^^^^^^^
  File "/ailab/user/dailinrui/.conda/envs/ccdm/lib/python3.11/site-packages/wandb/sdk/wandb_init.py", line 747, in init
    result = run_init_handle.wait(
             ^^^^^^^^^^^^^^^^^^^^^
  File "/ailab/user/dailinrui/.conda/envs/ccdm/lib/python3.11/site-packages/wandb/sdk/lib/mailbox.py", line 283, in wait
    found, abandoned = self._slot._get_and_clear(timeout=wait_timeout)
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ailab/user/dailinrui/.conda/envs/ccdm/lib/python3.11/site-packages/wandb/sdk/lib/mailbox.py", line 130, in _get_and_clear
    if self._wait(timeout=timeout):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ailab/user/dailinrui/.conda/envs/ccdm/lib/python3.11/site-packages/wandb/sdk/lib/mailbox.py", line 126, in _wait
    return self._event.wait(timeout=timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ailab/user/dailinrui/.conda/envs/ccdm/lib/python3.11/threading.py", line 629, in wait
    signaled = self._cond.wait(timeout)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ailab/user/dailinrui/.conda/envs/ccdm/lib/python3.11/threading.py", line 331, in wait
    gotit = waiter.acquire(True, timeout)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt
